#!/usr/bin/env python3
import argparse
import json
import pathlib

arg_parser = argparse.ArgumentParser(description='RSS scanner that fetches and extracts article text to feed name directories')
arg_parser.add_argument('--config', nargs=1, type=str, help='the location of the config file')
arg_parser.add_argument('--output', nargs=1, type=str, help='the output directory to store articles in')

if __name__ == '__main__': # which it will:
    args = arg_parser.parse_args()
    args_dict = vars(args)
    # parse the config file
    config_location = args_dict.get('config', './rss_config.json')
    output_dir = args_dict.get('output', './articles')
    with open(config_location, 'r') as config_file:
        config_data = config_file.read()
        config = json.loads(config_file)

    # now make the out put dir
    pathlib.Path(output_dir).mkdir(parents=True, exist_ok=True)

    # TODO: For each key along to way to a url in the feeds config make a directory in the output dir
    # and fetch all items in the feeds for that url, placing it in the leaf node directory made
    
